groups:
- name: cadvisor
  interval: 5s
  rules:
  - record: cadvisor_nomad_network_receive_bytes
    expr: (max by(container_label_com_hashicorp_nomad_alloc_id, container_label_com_hashicorp_nomad_job_name) (container_tasks_state{container_label_com_hashicorp_nomad_job_name!=""})) + on (container_label_com_hashicorp_nomad_alloc_id) group_right(container_label_com_hashicorp_nomad_job_name) (label_replace(container_network_receive_bytes_total{image=~"registry.k8s.io/pause-amd64.*"}, "container_label_com_hashicorp_nomad_alloc_id", "$1", "name", "nomad_init_(.*)"))
  - record: cadvisor_nomad_network_transmit_bytes
    expr: (max by(container_label_com_hashicorp_nomad_alloc_id, container_label_com_hashicorp_nomad_job_name) (container_tasks_state{container_label_com_hashicorp_nomad_job_name!=""})) + on (container_label_com_hashicorp_nomad_alloc_id) group_right(container_label_com_hashicorp_nomad_job_name) (label_replace(container_network_transmit_bytes_total{image=~"registry.k8s.io/pause-amd64.*"}, "container_label_com_hashicorp_nomad_alloc_id", "$1", "name", "nomad_init_(.*)"))
